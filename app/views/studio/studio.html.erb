<% content_for :head do %>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.css"/>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.js"></script>
<% end %>

<div class="bg-nordik-bg min-h-screen py-12 px-6">
  <div class="max-w-7xl mx-auto">
    
    <div class="text-center mb-12">
      <h1 class="text-4xl font-sans tracking-[0.2em] text-nordik-primary uppercase">
        Virtual Studio Tour
      </h1>
      <div class="h-0.5 w-12 bg-nordik-accent mx-auto mt-4 mb-4"></div>
      <p class="text-nordik-secondary font-light">
        Explore our creative space in 360ยบ.
      </p>
    </div>

    <div class="relative w-full aspect-video md:h-[600px] rounded-2xl overflow-hidden shadow-2xl border-4 border-white">
      
      <div id="panorama" class="w-full h-full"></div>
      
      <div id="loading" class="absolute inset-0 flex items-center justify-center bg-nordik-bg pointer-events-none z-10 transition-opacity duration-500">
        <span class="text-nordik-accent text-xs font-bold tracking-widest uppercase animate-pulse">Loading 360 View...</span>
      </div>

    </div>

    <div class="text-center mt-6">
      <p class="text-xs text-nordik-secondary uppercase tracking-widest">
        <span class="inline-block border border-nordik-secondary/30 px-2 py-1 rounded mr-2">Mouse</span> Drag to rotate
      </p>
    </div>

  </div>
</div>

<script>
  document.addEventListener("turbo:load", function() {
    
    const imageUrl = "<%= asset_path('studio_360.webp') %>"; 


    pannellum.viewer('panorama', {
      "type": "equirectangular",
      "panorama": imageUrl,
      "autoLoad": true,
      "autoRotate": -2, 
      "compass": false,
      "showControls": true
    });


    setTimeout(() => {
      document.getElementById('loading').style.opacity = '0';
    }, 1000);
  });
</script>

<style>

  .pnlm-container {
    background-color: #F5F2E9;
  }
</style>